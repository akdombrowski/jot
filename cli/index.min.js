#!/usr/bin/env node
import{jwtDecode,base64URLEncode}from"../src/index.js";import clipboardy from"clipboardy";const GENERIC_ERROR_CODE=1,decode=async o=>{try{return await jwtDecode(o)}catch(o){throw o}};export const HELP_TEXT="******HELP*****\nuse -c or --clipboard or call command with no arguments to decode the JWT in your clipboard\nor call command with JWT as first argument\n****************";export const cli=async(o,r)=>{let e,n;if(r&&(e=r[2],n=r[3]),"-h"==e||"--help"===e)return console.log(HELP_TEXT),HELP_TEXT;if("-c"!==e&&"--clipboard"!==e&&e)if("-b"===e||"--base64url"===e){if(!n)return console.error("I found an error :("),console.error("No argument passed in to encode."),1;try{const o=base64URLEncode(n);return console.log(o),o}catch(o){console.error("I found an error :("),console.error("base64url encoding failed:",o.message)}}else if(e)try{const o=jwtDecode(e);console.log("Decoding: \n"+e),console.log(o)}catch(o){console.error("I found an error :(."),console.error(o.message)}else console.error("I found an error :(."),console.error("Nothing in clipboard and no arguments given. Pass in a JWT as the first argument or copy a JWT to your clipboard");else{if(!o)return console.error("I found an error :("),console.error("Didn't find anything in your clipboard."),1;try{console.log("Decoding: "),console.log(o);const r=await decode(o);return console.log(r),r}catch(r){return console.error("I found an error :("),console.error("Couldn't decode what was in your clipboard. You might try copying the JWT again."),console.error("What's the problem? "),console.error(" ",r.message),console.error("What's on your clipboard? "),console.error(" ",o),1}}};let clipboard;try{clipboard=clipboardy.readSync()}catch(o){clipboard=null}const argv=process.argv;cli(clipboard,argv);export default cli;