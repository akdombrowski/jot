#!/usr/bin/env node
import{jwtDecode,base64URLEncode}from"../lib";import clipboardy from"clipboardy";const GENERIC_ERROR_CODE=1,decode=async o=>{try{return await jwtDecode(o)}catch(o){throw o}};export const HELP_TEXT="******HELP*****\nuse -c or --clipboard or call command with no arguments to decode the JWT in your clipboard\nor call command with JWT as first argument\n****************";export const cli=async(o,r)=>{let e,n;if(r&&(e=r[2],n=r[3]),"-h"==e||"--help"===e)return console.log(HELP_TEXT),HELP_TEXT;if("-c"!==e&&"--clipboard"!==e&&e)if("-b"===e||"--base64url"===e){if(!n)return console.error("I found an error :("),console.error("No argument passed in to encode."),1;try{const o=base64URLEncode(n);return console.log(o),o}catch(o){throw console.error("I found an error :("),console.error("base64url encoding failed:",o.message),o}}else{if(!e)throw console.error("I found an error :(."),console.error("Nothing in clipboard and no arguments given. Pass in a JWT as the first argument or copy a JWT to your clipboard"),new Error("Nothing in clipboard and no arguments given. Pass in a JWT as the first argument or copy a JWT to your clipboard");try{const o=jwtDecode(e);return console.log("Decoding: \n"+e),console.log(o),o}catch(o){throw console.error("I found an error :(."),console.error(o,o.message),o}}else{if(!o)return console.error("I found an error :("),console.error("Nothing in your clipboard. Pass in a JWT as the first argument or copy a JWT to your clipboard"),1;try{const r=await decode(o);return console.log("Decoding: "),console.log(o),console.log(r),r}catch(r){throw console.error("I found an error :("),console.error("Couldn't decode what was in clipboard. Pass in a JWT as the first argument or copy a JWT to your clipboard"),console.error("what's on your clipboard? "),console.error(o),r}}};let clipboard;try{clipboard=clipboardy.readSync()}catch(o){clipboard=null}const argv=process.argv;cli(clipboard,argv);export default cli;
